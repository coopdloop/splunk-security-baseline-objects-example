# Palo Alto Firewall - Props.conf Example
# This example shows CIM-compliant field extraction for Palo Alto firewall logs

[pan:traffic]
# Time extraction
TIME_PREFIX = \d{4}/\d{2}/\d{2}\s
TIME_FORMAT = %Y/%m/%d %H:%M:%S
MAX_TIMESTAMP_LOOKAHEAD = 25

# Basic field extractions
EXTRACT-src_ip = ,(?<src_ip>\d+\.\d+\.\d+\.\d+),\d+,(?<dest_ip>\d+\.\d+\.\d+\.\d+),\d+
EXTRACT-dest_ip = ,\d+\.\d+\.\d+\.\d+,\d+,(?<dest_ip>\d+\.\d+\.\d+\.\d+),\d+
EXTRACT-src_port = ,\d+\.\d+\.\d+\.\d+,(?<src_port>\d+),\d+\.\d+\.\d+\.\d+,\d+
EXTRACT-dest_port = ,\d+\.\d+\.\d+\.\d+,\d+,\d+\.\d+\.\d+\.\d+,(?<dest_port>\d+)
EXTRACT-action = ,(?<action>allow|deny|drop|reset),
EXTRACT-protocol = ,(?<protocol>tcp|udp|icmp),
EXTRACT-bytes_out = ,(?<bytes_out>\d+),\d+$
EXTRACT-bytes_in = ,\d+,(?<bytes_in>\d+)$

# CIM compliance
EVAL-vendor_product = "Palo Alto Firewall"
EVAL-dest = dest_ip
EVAL-src = src_ip
EVAL-bytes = bytes_in + bytes_out

# Field aliases for CIM
FIELDALIAS-source_ip = src_ip AS src
FIELDALIAS-destination_ip = dest_ip AS dest

[pan:threat]
# Threat log field extractions
EXTRACT-threat_name = threat[/\s]+(?<signature>[^,]+)
EXTRACT-severity = severity[=:\s]+(?<severity>\w+)
EXTRACT-category = category[=:\s]+(?<category>[^,]+)

# CIM compliance for malware data model
EVAL-vendor_product = "Palo Alto Firewall"
EVAL-file_name = if(isnull(filename), "unknown", filename)
```