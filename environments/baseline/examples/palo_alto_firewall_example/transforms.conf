# Palo Alto Firewall - Transforms.conf Example
# Advanced field transformations and lookup definitions

[pan_severity_mapping]
REGEX = severity[=:\s]+(?<original_severity>\w+)
FORMAT = severity::$1
# Map vendor severity to CIM standard
EVAL-severity = case(
    original_severity=="critical","critical",
    original_severity=="high","high", 
    original_severity=="medium","medium",
    original_severity=="low","low",
    original_severity=="informational","informational",
    1=1,"unknown"
)

[pan_action_normalization]
REGEX = action[=:\s]+(?<raw_action>\w+)
# Normalize actions to CIM standards
EVAL-action = case(
    raw_action=="allow","allowed",
    raw_action=="deny","blocked",
    raw_action=="drop","blocked",
    raw_action=="reset-client","blocked",
    raw_action=="reset-server","blocked",
    raw_action=="reset-both","blocked",
    1=1,raw_action
)

# Threat intelligence lookup definition
[threat_intel_lookup]
filename = threat_indicators.csv
case_sensitive_match = false
match_type = WILDCARD(threat_indicator)
min_matches = 1
max_matches = 1000

# Geographic IP lookup
[geo_ip_lookup]
filename = geoip_database.csv
case_sensitive_match = false

# Asset inventory lookup
[asset_lookup] 
filename = asset_inventory.csv
case_sensitive_match = false